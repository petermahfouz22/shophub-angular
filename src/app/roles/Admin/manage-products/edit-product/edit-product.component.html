<div class="max-w-3xl mx-auto bg-white p-6 rounded-lg shadow">
  <h2 class="text-2xl font-semibold mb-6">Edit Product</h2>

  <form *ngIf="form" [formGroup]="form" (ngSubmit)="onSubmit()">
    <!-- Name -->
    <div class="mb-4">
      <label class="block font-medium mb-1">Name</label>
      <input type="text" formControlName="name" class="w-full border p-2 rounded" />
      <p *ngIf="form.get('name')?.touched && form.get('name')?.invalid" class="text-red-500 text-sm">
        Name is required and must be under 255 characters.
      </p>
    </div>

    <!-- Description -->
    <div class="mb-4">
      <label class="block font-medium mb-1">Description</label>
      <textarea formControlName="description" class="w-full border p-2 rounded"></textarea>
      <p *ngIf="form.get('description')?.touched && form.get('description')?.invalid" class="text-red-500 text-sm">
        Description is required.
      </p>
    </div>

    <!-- Category -->
    <div class="mb-4">
      <label class="block font-medium mb-1">Category</label>
      <select formControlName="category_id" class="w-full border p-2 rounded">
        <option *ngFor="let cat of categories" [value]="cat.id">{{ cat.name }}</option>
      </select>
    </div>

    <!-- Brand -->
    <div class="mb-4">
      <label class="block font-medium mb-1">Brand</label>
      <select formControlName="brand_id" class="w-full border p-2 rounded">
        <option *ngFor="let brand of brands" [value]="brand.id">{{ brand.name }}</option>
      </select>
    </div>

    <!-- Price -->
    <div class="mb-4">
      <label class="block font-medium mb-1">Price</label>
      <input type="number" formControlName="price" class="w-full border p-2 rounded" />
    </div>

    <!-- Discount -->
    <div class="mb-4">
      <label class="block font-medium mb-1">Discount Price</label>
      <input type="number" formControlName="discount_price" class="w-full border p-2 rounded" />
    </div>

    <!-- Stock -->
    <div class="mb-4">
      <label class="block font-medium mb-1">Stock</label>
      <input type="number" formControlName="stock" class="w-full border p-2 rounded" />
    </div>

    <!-- SKU -->
    <!-- <div class="mb-4">
      <label class="block font-medium mb-1">SKU</label>
      <input type="text" formControlName="sku" class="w-full border p-2 rounded" />
    </div> -->

    <!-- Image -->
    <div class="mb-4">
      <label class="block font-medium mb-1">Image URL</label>
      <input type="text" formControlName="image_url" class="w-full border p-2 rounded" />
      <img
        *ngIf="form.get('image_url')?.value"
        [src]="form.get('image_url')?.value"
        alt="Preview"
        class="mt-2 w-32 h-32 object-cover rounded"
      />
    </div>

    <!-- Gallery -->
    <div class="mb-4">
      <label class="block font-medium mb-1">Gallery</label>
      <div formArrayName="gallery">
        <div *ngFor="let g of gallery.controls; let i = index" class="flex items-center gap-2 mb-2">
          <input type="text" [formControlName]="i" class="flex-1 border p-2 rounded" />
          <button
            type="button"
            (click)="removeGalleryUrl(i)"
            class="bg-red-500 text-white px-2 py-1 rounded"
          >
            Remove
          </button>
        </div>
      </div>
      <button
        type="button"
        (click)="addGalleryUrl()"
        class="bg-green-600 text-white px-3 py-1 rounded"
      >
        + Add URL
      </button>
    </div>

    <!-- Rating -->
    <div class="mb-4">
      <label class="block font-medium mb-1">Rating</label>
      <input type="number" formControlName="rating" class="w-full border p-2 rounded" min="0" max="5" step="0.1" />
    </div>

    <!-- Status -->
    <div class="mb-4">
      <label class="block font-medium mb-1">Status</label>
      <select formControlName="status" class="w-full border p-2 rounded">
        <option value="active">Active</option>
        <option value="inactive">Inactive</option>
      </select>
    </div>

    <button
      type="submit"
      [disabled]="form.invalid"
      class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50"
    >
      Save Changes
    </button>
  </form>

  <p *ngIf="successMessage" class="text-green-600 mt-3">{{ successMessage }}</p>
  <p *ngIf="errorMessage" class="text-red-600 mt-3">{{ errorMessage }}</p>
</div>
